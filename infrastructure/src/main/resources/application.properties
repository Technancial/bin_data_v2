# =============================================================================
# LOGGING CONFIGURATION
# =============================================================================

# Global log level (default for all categories)
quarkus.log.level=INFO

# Application-specific logging levels
quarkus.log.category."pe.soapros".level=INFO
quarkus.log.category."pe.soapros.document.infrastructure".level=DEBUG

# Framework logging levels (reduce noise)
quarkus.log.category."io.quarkus".level=WARN
quarkus.log.category."org.jboss".level=WARN
quarkus.log.category."io.netty".level=WARN
quarkus.log.category."software.amazon.awssdk".level=WARN

# Console logging format (default: not JSON)
quarkus.log.console.json=false
quarkus.log.console.format=%d{yyyy-MM-dd HH:mm:ss,SSS} %-5p [%c{3.}] (%t) %s%e%n

# File logging (disabled by default, enabled in prod)
quarkus.log.file.enable=false

# Production logging overrides
%prod.quarkus.log.console.json=true
%prod.quarkus.log.console.json.pretty-print=false
%prod.quarkus.log.file.enable=true
%prod.quarkus.log.file.path=/tmp/quarkus-app.log
%prod.quarkus.log.file.rotation.max-file-size=10M
%prod.quarkus.log.file.rotation.max-backup-index=5
%prod.quarkus.log.category."pe.soapros".level=INFO

# REST API configuration
quarkus.rest.default-produces=application/json

# AWS Lambda configuration
# Default handler for Kafka events (can be overridden)
quarkus.lambda.handler=kafka

# Local testing configuration
%dev.quarkus.lambda.enable-polling-jvm-mode=true

# AWS S3 Configuration for document storage
# Override these values via environment variables in Lambda
aws.s3.bucket.documents=${S3_DOCUMENTS_BUCKET:my-documents-bucket}
aws.s3.prefix.documents=${S3_DOCUMENTS_PREFIX:generated-documents}
aws.s3.bucket.templates=${S3_TEMPLATES_BUCKET:nexux-templates}
aws.s3.endpoint=${AWS_ENDPOINT_URL:}
aws.region=${AWS_REGION:us-east-1}
app.generation.temp=${GENERATION_TEMP:/Users/furth/Documents/02-Fuentes/temp}

# =============================================================================
# KAFKA CONFIGURATION (AWS MSK Integration for Lambda)
# =============================================================================
#
# NOTA: El consumer está gestionado por AWS Lambda Event Source Mapping (ESM).
# Solo necesitamos configurar el producer para enviar resultados a MSK.

# Kafka broker configuration (AWS MSK bootstrap servers)
kafka.bootstrap.servers=${KAFKA_BOOTSTRAP_SERVERS:localhost:9092}

# Kafka Producer configuration (para enviar resultados a tópico de salida)
# Canal: document-responses-manual (usado por DocumentResultProducer)
mp.messaging.outgoing.document-responses-manual.connector=smallrye-kafka
mp.messaging.outgoing.document-responses-manual.topic=${KAFKA_TOPIC_RESPONSES:document-responses}
mp.messaging.outgoing.document-responses-manual.value.serializer=org.apache.kafka.common.serialization.StringSerializer
mp.messaging.outgoing.document-responses-manual.key.serializer=org.apache.kafka.common.serialization.StringSerializer

# Producer reliability settings
mp.messaging.outgoing.document-responses-manual.acks=all
mp.messaging.outgoing.document-responses-manual.retries=3
mp.messaging.outgoing.document-responses-manual.max.in.flight.requests.per.connection=1

# Performance optimizations for large JSON payloads
mp.messaging.outgoing.document-responses-manual.compression.type=gzip
mp.messaging.outgoing.document-responses-manual.batch.size=16384
mp.messaging.outgoing.document-responses-manual.linger.ms=10
mp.messaging.outgoing.document-responses-manual.buffer.memory=67108864
mp.messaging.outgoing.document-responses-manual.max.request.size=10485760

# =============================================================================
# DEVELOPMENT MODE OVERRIDES (LocalStack and Local Kafka)
# =============================================================================

# Development logging (more verbose for debugging)
%dev.quarkus.log.console.json=false
%dev.quarkus.log.category."pe.soapros".level=DEBUG
%dev.quarkus.log.file.enable=false

# Development AWS S3 Configuration
%dev.aws.s3.bucket.documents=local-documents-bucket
%dev.aws.s3.prefix.documents=generated-documents
%dev.aws.s3.bucket.templates=local-templates-bucket
%dev.aws.s3.endpoint=http://localstack:4566
%dev.aws.region=us-east-1

# Development Kafka Configuration (local broker)
%dev.kafka.bootstrap.servers=localhost:9092
%dev.mp.messaging.outgoing.document-responses-manual.topic=dev-document-responses